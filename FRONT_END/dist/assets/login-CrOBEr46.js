import{j as e,r as p,u as h,L as g}from"./index-UOv0aOmZ.js";import{v as x,B as n}from"./react-toastify.esm-DMNvulCs.js";const j="/assets/fillBox-C19ApUlK.png",v=({cpf:s,handleCpfChange:r})=>e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"uk-inline",children:[e.jsx("span",{className:"uk-form-icon text-[#f97316]",style:{color:"#f97316"},"data-uk-icon":"icon: user"}),e.jsx("input",{className:"uk-input border-light-500 rounded w-64 focus:border-orange-500 text-light-400",placeholder:"CPF",type:"text",id:"cpf",name:"cpf",value:s,maxLength:11,onChange:r,required:!0,"aria-label":"Not clickable icon"})]})}),w=({password:s,handlePasswordChange:r})=>e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"uk-inline",children:[e.jsx("span",{className:"uk-form-icon",style:{color:"#f97316"},"data-uk-icon":"icon: lock"}),e.jsx("input",{className:"uk-input border-light-500 rounded w-64 focus:border-orange-500 text-light-400",placeholder:"Senha",type:"password",id:"password",name:"password",value:s,onChange:r,required:!0,"aria-label":"Not clickable icon"})]})}),b=async s=>{try{console.log("Enviando dados de login:",s);const r=await fetch("bankinapi20240623181422.azurewebsites.net/GenerateToken/autentica",{method:"POST",body:JSON.stringify({iD_USUARIO:0,nome:"",sobrE_NOME:"",senha:s.password,email:"",saldo:0,token:"",cpf:s.cpf,usu:s.cpf}),headers:{Accept:"application/json","Content-Type":"application/json"}});if(!r.ok){const t=await r.json();throw console.error("Erro na resposta do servidor:",t),new Error(`HTTP error! Status: ${r.status}, Errors: ${JSON.stringify(t.errors)}`)}const o=await r.json();return console.log("Resultado do login:",o),o.isSuccess?(localStorage.setItem("token",o.token),localStorage.setItem("nome",o.result.nome),localStorage.setItem("sobrenome",o.result.sobrE_NOME),localStorage.setItem("saldo",o.result.saldo.toString()),o.token):(console.error("Erro no login:",o.displayMessage),null)}catch(r){return console.error("Erro ao fazer login:",r),null}},N=()=>{const[s,r]=p.useState({cpf:"",password:""}),[o,t]=p.useState({cpf:"",password:""}),i=h();return{formData:s,errors:o,handleInputChange:c=>{const{name:a,value:l}=c.target;r(f=>{const m={...f,[a]:l},u={...o};return a==="cpf"&&(u.cpf=x(l)),t(u),m})},handleSubmit:async c=>{if(c.preventDefault(),Object.values(o).every(a=>a===""))try{console.log("Formulário enviado com os dados:",s);const a=await k(s.password);await b({...s,password:a})?(n.success("Login realizado com sucesso!"),i("/home")):n.error("Erro ao fazer login. Por favor, verifique seus dados e tente novamente.")}catch(a){n.error("Erro ao fazer login. Por favor, verifique seus dados e tente novamente."),console.error("Erro ao fazer login:",a)}else n.error("Por favor, corrija os erros no formulário antes de continuar.")}}};async function k(s){const r=new TextEncoder().encode(s),o=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(o)).map(d=>d.toString(16).padStart(2,"0")).join("")}const C=()=>{const{formData:s,errors:r,handleInputChange:o,handleSubmit:t}=N();return e.jsxs("div",{className:"bg-darkBackground h-screen w-screen flex justify-center items-center flex-col font-inter",children:[e.jsx("img",{src:j,alt:"Descrição da imagem",className:"loginImg md:w-[20%]"}),e.jsx("div",{className:"flex items-center justify-center flex-col",children:e.jsx("div",{children:e.jsxs("form",{onSubmit:t,children:[e.jsxs("div",{className:"p-10",children:[e.jsx(v,{cpf:s.cpf,handleCpfChange:o}),r.cpf&&e.jsx("p",{className:"text-red-500",children:r.cpf}),e.jsx(w,{password:s.password,handlePasswordChange:o})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center",children:[e.jsx("button",{className:"text-black font-semibold font-inter text-lg w-64 bg-light-200 rounded p-2",type:"submit",children:"LOGIN"}),e.jsxs("h3",{className:"pt-3 text-light-400",children:["Esqueceu a senha? ",e.jsx(g,{to:"/cadastro",className:"text-orange-500",children:"Nova senha"})]})]})]})})})]})};export{C as default};
